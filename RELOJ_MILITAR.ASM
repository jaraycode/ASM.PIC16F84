        LIST P=16F84A

; Todas las variables relacionadas con sistema
STATUS      EQU     03H;
PA          EQU     05H;
TRISA       EQU     05H;    
PB          EQU     06H;
TRISB       EQU     06H;
OP          EQU     01H;
TMR0        EQU     01H;
INTCON      EQU     0BH;

; Variables para poder marcar los segundos
VAR         EQU     10H;
VAR2        EQU     11H;

        ORG     0; INICIO DE PROGRAMA
        GOTO    INICIO;

INICIO  ORG     10;
        BSF     STATUS,5     ; CAMBIO A BANCO DE MEMORIA 1, DONDE SE ASIGNAN LOS METADATOS
        CLRF    TRISA        ; SALIDA QUE AYUDO A CONTROLAR CUALES SON LOS DISPLAYS QUE SE VAN A PRENDER
        CLRF    TRISB        ; HACIENDO QUE EL PUERTO B, QUE TIENE MAYOR CANTIDAD DE SALIDAS, SEA EL ASIGNADO PARA GENERAR LOS NUMEROS
        MOVLW   B'00000110'  ; METO DENTRO DE LA VARIABLE W DEL SISTEMA EL VALOR DECIMAL QUE GENERA UN DIVISOR PARA LAS INTERRUPCIONES
        MOVWF   OP           ; LO MUEVO A LA VARIABLE DE CONTROL DE SISTEMA PARA GENERAR QUE EL TEMPORIZADOR FUNCIONE
        BCF     STATUS,5     ; REGRESO A BANCO DE MEMORIA 0, DONDE SE GENERA TODO EL CODIGO

        ; SALIDA BASE UNA VEZ DADA LA CORRIENTE AL CIRCUITO
        MOVLW   B'10000000'  ; opcion 1 // la opcion 2 sería b'01111111'
        MOVWF   PB

        ; ACTIVAR TODOS LOS PUERTOS
        MOVLW   B'00001111';

        ; ACTIVANDO LAS BANDERAS DE LAS INTERRUPCIONES
        MOVLW   B'10100000'
        MOVWF   INTCON

        ; RELACIONADO CON EL TEMPORIZADOR
        MOVLW   D'178'
        MOVWF   TMR0

        MOVLW   D'200'
        MOVWF   VAR        ; GARANTIZA QUE SE EJECUTE UN SEGUNDO CON LA CONFIGURACIÓN ESTABLECIDA POR EL OP Y TMR0

        MOVLW   D'60'
        MOVWF   VAR2       ; GARANTIZA QUE PASEN EXACTAMENTE 60 SEGUNDOS PARA CAMBIAR EL ESTADO

; CICLO DE LOOP PARA QUE TRABAJE LA INTERRUPCIÓN
X1      NOP
        NOP
        GOTO    X1

        ORG     04         ; UNA VEZ REALIZADA LA INTERRUPCIÓN SUELE SALTAR A LA LINEA 4
        GOTO    TIME

TIME    ORG     50;
        DECFSZ  VAR,1      ; DECREMENTA EL VALOR DE VAR -1 Y CUANDO SEA 0 SALTA DE LINEA, PARA ESTE MOMENTO CUANDO HAGA EL SALTO DE LÍNEA DEBE HABER PASADO 1 SEGUNDO
        GOTO    X2
        DECFSZ  VAR2,1     ; SIMILAR AL ANTERIOR Y EN CASO DE QUE SALTE UNA LINEA SIGNIFICA QUE HABRÁ PASADO 1 MINUTO EXACTO
        GOTO    X3

        ; SE DEJA EL ESPACIO PARA PODER REALIZAR LA LÓGICA DETRÁS DE LOS ESTADOS DEL RELOJ MILITAR
        


        MOVLW   D'60'
        MOVWF   VAR2

X3      MOVLW   D'200'
        MOVWF   VAR

X2      MOVLW   D'178'
        MOVWF   TMR0

        BCF     INTCON,2  ; APAGA LA BANDERA DE LA INTERRUPCIÓN PARA QUE LA MISMA SE PUEDA VOLVER A GENERAR
        RETFIE            ; ESTA PALABRA RESERVADA LO QUE HACE ES REGRESAR A LA LÍNEA DONDE SE GENERÓ LA INTERRUPCIÓN, EN ESTE CASO SERÍA EL TAG X1

        END               ; FIN DE PROGRAMA
